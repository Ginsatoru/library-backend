@model LibrarySystemBBU.Models.LibraryLog
@{
    ViewData["Title"] = "Log Details";

    string status = Model?.Status ?? "Pending";
    string statusClass = status switch
    {
        "Approved" => "b-approved",
        "Returned" => "b-returned",
        _ => "b-pending"
    };
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

<style>
    /* ==========================
           Library Log Details – scoped
           Reuse global glass / brand
           ========================== */

    #libraryLogDetailsPage .muted {
        color: var(--muted, #667085);
        font-size: .9rem;
    }

    #libraryLogDetailsPage .card-glass.glas-all-style {
        margin-top: 4px;
    }

    #libraryLogDetailsPage dl.row dt {
        font-weight: 600;
        color: var(--text, #0f0f2e);
    }

    #libraryLogDetailsPage dl.row dd {
        margin-bottom: .35rem;
    }

    /* Status pills */
    #libraryLogDetailsPage .status-pill {
        display: inline-block;
        padding: .25rem .6rem;
        border-radius: 999px;
        border: 1px solid #dfe3ff;
        font-weight: 700;
        font-size: .82rem;
    }

    #libraryLogDetailsPage .b-pending {
        background: #fff7e6;
        color: #8a5a00;
        border-color: #ffe3ad;
    }

    #libraryLogDetailsPage .b-approved {
        background: #e7fff0;
        color: #066e3c;
        border-color: #b8f5d2;
    }

    #libraryLogDetailsPage .b-returned {
        background: #eef1ff;
        color: #2b2f7f;
        border-color: #dfe3ff;
    }

    /* Book chips */
    #libraryLogDetailsPage .chip {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        border: 1px solid rgba(1,0,140,.12);
        border-radius: 999px;
        padding: 6px 10px;
        margin: 6px 6px 0 0;
        background: linear-gradient(180deg,#fff,#f7f8ff);
        font-size: .85rem;
    }

        #libraryLogDetailsPage .chip i {
            font-size: .9rem;
        }

    /* Footer actions */
    #libraryLogDetailsPage .actions-bar {
        border-top: 1px solid rgba(15,23,42,.06);
        padding: 12px 16px 14px;
    }
</style>

<div id="libraryLogDetailsPage">
    <h2 class="page-title">
        <span class="logo-dot"></span>
        Log Details
    </h2>

    <div class="card-glass glas-all-style">
        <!-- HEADER -->
        <div class="card-header d-flex justify-content-between align-items-center">
            <div>
                <i class="bi bi-journal-text"></i> Header
            </div>
            <div>
                <span class="status-pill @statusClass">@status</span>
            </div>
        </div>

        <!-- MAIN INFO -->
        <div class="card-body">
            <dl class="row mb-0">
                <dt class="col-sm-3">Student</dt>
                <dd class="col-sm-9">@Model.StudentName</dd>

                <dt class="col-sm-3">Phone</dt>
                <dd class="col-sm-9">@Model.PhoneNumber</dd>

                <dt class="col-sm-3">Gender</dt>
                <dd class="col-sm-9">@Model.Gender</dd>

                <dt class="col-sm-3">Visit Date</dt>
                <dd class="col-sm-9">@Model.VisitDate.ToString("yyyy-MM-dd")</dd>

                <dt class="col-sm-3">Purpose</dt>
                <dd class="col-sm-9">@Model.Purpose</dd>

                <dt class="col-sm-3">Notes</dt>
                <dd class="col-sm-9">@Model.Notes</dd>

                <dt class="col-sm-3">Created (UTC)</dt>
                <dd class="col-sm-9">@Model.CreatedUtc.ToString("yyyy-MM-dd HH:mm")</dd>

                <dt class="col-sm-3">Approved On (UTC)</dt>
                <dd class="col-sm-9">
                    @(Model.ApprovedUtc.HasValue
                        ? Model.ApprovedUtc.Value.ToString("yyyy-MM-dd HH:mm")
                        : "—")
                </dd>

                <dt class="col-sm-3">Returned On (UTC)</dt>
                <dd class="col-sm-9">
                    @(Model.ReturnedUtc.HasValue
                        ? Model.ReturnedUtc.Value.ToString("yyyy-MM-dd HH:mm")
                        : "—")
                </dd>
            </dl>
        </div>

        <!-- BOOKS -->
        <div class="card-header">
            <i class="bi bi-bookshelf"></i> Books
        </div>
        <div class="card-body">
            @if (Model.Items == null || !Model.Items.Any())
            {
                <div class="muted">No books recorded for this log.</div>
            }
            else
            {
                foreach (var it in Model.Items)
                {
                    var title = it.Book?.Catalog?.Title ?? it.Book?.Title ?? "(Unknown)";
                    var barcode = it.Book?.Barcode ?? "—";
                    <span class="chip">
                        <i class="bi bi-journal-bookmark"></i>
                        @($"{title} ({barcode})")
                    </span>
                }
            }
        </div>

        <!-- ACTIONS -->
        <div class="card-body actions-bar d-flex gap-2 justify-content-end">
            <a asp-action="Index" class="btn-glass btn-outline">
                <i class="bi bi-arrow-left"></i> Back
            </a>
            <a asp-action="Edit"
               asp-route-id="@Model.LogId"
               class="btn-glass btn-brand">
                <i class="bi bi-pencil-square"></i> Edit
            </a>
        </div>
    </div>
</div>
